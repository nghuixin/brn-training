res$statistic
#tidy()
res$parameter
#tidy()
res$p.value
df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
dcast(`Country Name` ~ Year, value.var = "Life expectancy at birth, total (years)", fill = NA) %>%
mutate(diff = `2007` - `1962`) %>%
arrange(desc(diff)) %>%
head(5) %>%
ggplot(aes(x = reorder(`Country Name`, -diff), y = diff)) +
geom_bar(position = "dodge", stat = "identity", fill = "lightblue") +
theme_classic() +
ggtitle("Increase in Life Expectancy in Years (Period: 1962-2007)") +
ylab("Years") +
xlab("Country") +
geom_text(aes(label = round(diff, 2)), position = position_dodge(width = 0.9), vjust = -0.25)
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
dcast(`Country Name` ~ Year, value.var = "Life expectancy at birth, total (years)", fill = NA) %>%
mutate(diff = `2007` - `1962`) %>%
arrange(desc(diff)) %>%
head(5)
res
res$`Country Name`
mod
res <- df %>%
group_by(Year) %>%
do(tidy(cor.test(.$co2PerCap, .$gdpPercap, alternative = "two.sided", method = "kendall"))) %>%
arrange(desc(estimate)) %>%
head(1)
res
mod
mod <- df %>%
filter(continent %in% c("Asia", "Europe"), Year > 1990) %>%
glm(importPercentageGDP ~ continent, data = .) %>%
tidy()
mod
res <- df %>%
group_by(Year) %>%
summarise(
tidy(
cor.test(x = co2PerCap, y = gdpPercap)
)
) %>%
arrange(desc(estimate)) %>%
head(1)
res
res <- df %>%
group_by(Year) %>%
summarise(
tidy(
cor.test(x = co2PerCap, y = gdpPercap, method = 'kendall')
)
) %>%
arrange(desc(estimate)) %>%
head(1)
res
res <- df %>%
group_by(Year) %>%
summarise(
tidy(
cor.test(x = co2PerCap, y = gdpPercap, method = 'kendall')
)
) %>%
arrange(desc(estimate)) %>%
dplyr::slice_max()
res <- df %>%
group_by(Year) %>%
summarise(
tidy(
cor.test(x = co2PerCap, y = gdpPercap, method = 'kendall')
)
) %>%
dplyr::slice_max(1)
res <- df %>%
group_by(Year) %>%
summarise(
tidy(
cor.test(x = co2PerCap, y = gdpPercap, method = 'kendall')
)
) %>%
dplyr::slice_max(1)
res <- df %>%
group_by(Year) %>%
summarise(
tidy(
cor.test(x = co2PerCap, y = gdpPercap, method = 'kendall')
)
) %>%  slice_max(1)
df %>%
group_by(Year) %>%
summarise(
tidy(
cor.test(x = co2PerCap, y = gdpPercap, method = 'kendall')
)
)
res <- df %>%
group_by(Year) %>%
summarise(
tidy(
cor.test(x = co2PerCap, y = gdpPercap, method = 'kendall')
)
) %>%  dplyr::slice_max(1)
res <- df %>%
group_by(Year) %>%
summarise(
tidy(
cor.test(x = co2PerCap, y = gdpPercap, method = 'kendall')
)
) %>%  dplyr::slice_max(.,1)
res <- df %>%
group_by(Year) %>%
summarise(
tidy(
cor.test(x = co2PerCap, y = gdpPercap, method = 'kendall')
)
) %>%  dplyr::slice_max(Year.,1)
res <- df %>%
group_by(Year) %>%
summarise(
tidy(
cor.test(x = co2PerCap, y = gdpPercap, method = 'kendall')
)
) %>%  dplyr::slice_max(Year,1)
res <- df %>%
group_by(Year) %>%
summarise(
tidy(
cor.test(x = co2PerCap, y = gdpPercap, method = 'kendall')
)
) %>%  dplyr::slice_max(Year,n=1)
res
res <- df %>%
group_by(Year) %>%
summarise(
tidy(
cor.test(x = co2PerCap, y = gdpPercap, method = 'kendall')
)
) %>%  dplyr::slice_max(estimate,n=1)
res <- df %>%
group_by(Year) %>%
summarise(
tidy(
cor.test(x = co2PerCap, y = gdpPercap, method = 'kendall')
)
) %>%  dplyr::slice_max(estimate,n=1)
res
fig <- df %>%
filter(Year == res$Year) %>%
plot_ly(
x = ~logGDP,
y = ~logCO2,
size = ~pop,
color = ~continent,
# frame = ~Year,
text = ~`Country Name`,
hoverinfo = "text",
type = "scatter",
mode = "markers"
)
fig <- fig %>% layout(
xaxis = list(
type = "log"
)
)
fig <- fig %>% animation_opts(
1000,
easing = "elastic", redraw = FALSE
)
fig %>%
layout(
title = "log GDP vs. log CO2 emissions in 1962", plot_bgcolor = "#e5ecf6", xaxis = list(title = "log CO2 Emissions"),
yaxis = list(title = "log GDP"), legend = list(title = list(text = "<b> Continent </b>"))
)
fig <- df %>%
filter(Year == res$Year) %>%
plot_ly(
x = ~logGDP,
y = ~logCO2,
size = ~pop,
color = ~continent,
# frame = ~Year,
text = ~`Country Name`,
hoverinfo = "text",
type = "scatter",
mode = "markers"
)
fig <- fig %>% layout(
xaxis = list(
type = "log"
)
)
fig <- fig %>% animation_opts(
1000,
easing = "elastic", redraw = FALSE
)
fig %>%
layout(
title = "log GDP vs. log CO2 emissions in 2002", plot_bgcolor = "#e5ecf6", xaxis = list(title = "log CO2 Emissions"),
yaxis = list(title = "log GDP"), legend = list(title = list(text = "<b> Continent </b>"))
)
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
)
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
group_by(Year) %>%
slice(1:3) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
)
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
group_by(Year) %>%
slice(1:3) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
)
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
)
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
# arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
)
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
# arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
# slice(1:3) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
)
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
)
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
group_by(Year) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
ggplot(data = ., aes(x = as.factor(Year), y = popDensityPerSqKm, fill = as.factor(`Country Name`))) +
geom_bar(position = "dodge", stat = "identity") +
theme_classic() +
labs(x = "Year", y = "population density (per sq.km)", fill = "Country") +
ggtitle("Population density in the top 5 highest density countries in Years 1962-2007")
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
)
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
)%>%
ggplot(data = ., aes(x = as.factor(Year), y = popDensityPerSqKm, fill = as.factor(`Country Name`))) +
geom_bar(position = "dodge", stat = "identity") +
theme_classic() +
labs(x = "Year", y = "population density (per sq.km)", fill = "Country") +
ggtitle("Population density in the top 5 highest density countries in Years 1962-2007")
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
#   mutate(
#   rnks = row_number(desc(popDensityPerSqKm))
# )
ggplot(data = ., aes(x = as.factor(Year), y = popDensityPerSqKm, fill = as.factor(`Country Name`))) +
geom_bar(position = "dodge", stat = "identity") +
theme_classic() +
labs(x = "Year", y = "population density (per sq.km)", fill = "Country") +
ggtitle("Population density in the top 5 highest density countries in Years 1962-2007")
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
ggplot(data = ., aes(x = as.factor(Year), y = popDensityPerSqKm, fill = as.factor(`Country Name`))) +
geom_bar(position = "dodge", stat = "identity") +
theme_classic() +
labs(x = "Year", y = "population density (per sq.km)", fill = "Country") +
ggtitle("Population density in the top 5 highest density countries in Years 1962-2007")
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
ggplot(data = ., aes(x = as.factor(Year), y = popDensityPerSqKm, fill = as.factor(`Country Name`))) +
geom_bar(position = "dodge", stat = "identity") +
theme_classic() +
labs(x = "Year", y = "population density (per sq.km)", fill = "Country") +
ggtitle("Population density in the top 5 highest density countries in Years 1962-2007")
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
)
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 10] - `Life expectancy at birth, total (years)`[Year == 1]
)%>%
#mutate(diff = `2007` - `1962`) %>%
arrange(desc(diff)) %>%
head(5)
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 10] - `Life expectancy at birth, total (years)`[Year == 1]
)%>%
#mutate(diff = `2007` - `1962`) %>%
arrange(desc(diff)) %>%
head(5)
res
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 10] - `Life expectancy at birth, total (years)`[Year == 1]
)#%>%
#mutate(diff = `2007` - `1962`) %>%
#arrange(desc(diff)) %>%
#head(5)
res
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 2007] - `Life expectancy at birth, total (years)`[Year == 1962]
)#%>%
#mutate(diff = `2007` - `1962`) %>%
#arrange(desc(diff)) %>%
#head(5)
res
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 2007] - `Life expectancy at birth, total (years)`[Year == 1962]
) %>%
dplyr::slice_max(`Life expectancy at birth, total (years)`, n=5)
df %>%
group_by(Year) %>%
summarise(
tidy(
cor.test(x = co2PerCap, y = gdpPercap, method = "kendall")
)
)
df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 2007] - `Life expectancy at birth, total (years)`[Year == 1962]
)
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 2007] - `Life expectancy at birth, total (years)`[Year == 1962]
) %>%
dplyr::slice_max(diff, n=5)
res
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 2007] - `Life expectancy at birth, total (years)`[Year == 1962]
) %>%
dplyr::slice_max(diff, n=5)
res
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 2007] - `Life expectancy at birth, total (years)`[Year == 1962]
) %>%  dplyr::slice_max(diff, n=5)
res
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
# group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 2007] - `Life expectancy at birth, total (years)`[Year == 1962]
) %>%  dplyr::slice_max(diff, n=5)
res
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 2007] - `Life expectancy at birth, total (years)`[Year == 1962]
) %>%  dplyr::slice_max(diff, n=5)
res
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 2007] - `Life expectancy at birth, total (years)`[Year == 1962]
) %>%  dplyr::slice_max(., n=5)
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 2007] - `Life expectancy at birth, total (years)`[Year == 1962]
) %>%  dplyr::slice_max(diff, n=5)
res
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 2007] - `Life expectancy at birth, total (years)`[Year == 1962]
, .groups = 'drop' ) %>%  dplyr::slice_max(diff, n=5)
res
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
) %<% mean(rnks)
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
) %>% mean(rnks)
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
mutate(
meanRnks = mean(row_number(desc(popDensityPerSqKm)))
)
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
)
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
)   %>%
group_by(`Country Name`) %>%
summarize(mean.rank = mean(rnks))
res <- df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
)   %>%
group_by(`Country Name`) %>%
summarize(mean.rank = mean(rnks))
res
max(res$"mean.rank")
res <- df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
) %>%
group_by(`Country Name`) %>%
summarize(mean.rank = mean(rnks))
res
