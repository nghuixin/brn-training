ggplot(data = ., aes(x = as.factor(Year), y = popDensityPerSqKm, fill = as.factor(`Country Name`))) +
geom_bar(position = "dodge", stat = "identity") +
theme_classic() +
labs(x = "Year", y = "population density (per sq.km)", fill = "Country") +
ggtitle("Population density in the top 5 highest density countries in Years 1962-2007")
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
ggplot(data = ., aes(x = as.factor(Year), y = popDensityPerSqKm, fill = as.factor(`Country Name`))) +
geom_bar(position = "dodge", stat = "identity") +
theme_classic() +
labs(x = "Year", y = "population density (per sq.km)", fill = "Country") +
ggtitle("Population density in the top 5 highest density countries in Years 1962-2007")
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
)
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 10] - `Life expectancy at birth, total (years)`[Year == 1]
)%>%
#mutate(diff = `2007` - `1962`) %>%
arrange(desc(diff)) %>%
head(5)
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 10] - `Life expectancy at birth, total (years)`[Year == 1]
)%>%
#mutate(diff = `2007` - `1962`) %>%
arrange(desc(diff)) %>%
head(5)
res
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 10] - `Life expectancy at birth, total (years)`[Year == 1]
)#%>%
#mutate(diff = `2007` - `1962`) %>%
#arrange(desc(diff)) %>%
#head(5)
res
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 2007] - `Life expectancy at birth, total (years)`[Year == 1962]
)#%>%
#mutate(diff = `2007` - `1962`) %>%
#arrange(desc(diff)) %>%
#head(5)
res
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 2007] - `Life expectancy at birth, total (years)`[Year == 1962]
) %>%
dplyr::slice_max(`Life expectancy at birth, total (years)`, n=5)
df %>%
group_by(Year) %>%
summarise(
tidy(
cor.test(x = co2PerCap, y = gdpPercap, method = "kendall")
)
)
df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 2007] - `Life expectancy at birth, total (years)`[Year == 1962]
)
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 2007] - `Life expectancy at birth, total (years)`[Year == 1962]
) %>%
dplyr::slice_max(diff, n=5)
res
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 2007] - `Life expectancy at birth, total (years)`[Year == 1962]
) %>%
dplyr::slice_max(diff, n=5)
res
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 2007] - `Life expectancy at birth, total (years)`[Year == 1962]
) %>%  dplyr::slice_max(diff, n=5)
res
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
# group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 2007] - `Life expectancy at birth, total (years)`[Year == 1962]
) %>%  dplyr::slice_max(diff, n=5)
res
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 2007] - `Life expectancy at birth, total (years)`[Year == 1962]
) %>%  dplyr::slice_max(diff, n=5)
res
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 2007] - `Life expectancy at birth, total (years)`[Year == 1962]
) %>%  dplyr::slice_max(., n=5)
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 2007] - `Life expectancy at birth, total (years)`[Year == 1962]
) %>%  dplyr::slice_max(diff, n=5)
res
res <- df %>%
select(Year, `Country Name`, `Life expectancy at birth, total (years)`) %>%
group_by(`Country Name`) %>%
summarise(
diff = `Life expectancy at birth, total (years)`[Year == 2007] - `Life expectancy at birth, total (years)`[Year == 1962]
, .groups = 'drop' ) %>%  dplyr::slice_max(diff, n=5)
res
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
) %<% mean(rnks)
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
) %>% mean(rnks)
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
mutate(
meanRnks = mean(row_number(desc(popDensityPerSqKm)))
)
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
)
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
)   %>%
group_by(`Country Name`) %>%
summarize(mean.rank = mean(rnks))
res <- df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
)   %>%
group_by(`Country Name`) %>%
summarize(mean.rank = mean(rnks))
res
max(res$"mean.rank")
res <- df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
) %>%
group_by(`Country Name`) %>%
summarize(mean.rank = mean(rnks))
res
list.of.packages <- c(
"tidyverse", "dplyr",
"styler", "reshape2",
"broom", "plotly"
)
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[, "Package"])]
if (length(new.packages)) {
install.packages(new.packages)
}
lapply(list.of.packages, require, character.only = TRUE)
# read as tibble
df <- read_csv(file = "gapminder_clean.csv")
style_file("R for DS.Rmd")
# rename columns
df <- df %>%
rename(
co2PerCap = "CO2 emissions (metric tons per capita)",
energyUsePerCap =
"Energy use (kg of oil equivalent per capita)",
importPercentageGDP =
"Imports of goods and services (% of GDP)",
popDensityPerSqKm =
"Population density (people per sq. km of land area)"
)
df %>%
filter(Year == 1962) %>%
ggplot(aes(y = co2PerCap, x = gdpPercap)) +
theme_classic() +
geom_point(color = "red") +
labs(y = "CO2 emissions (metric tons per capita)", x = "GDP in purchasing power parity (USD per capita)") +
ggtitle("GDP vs. CO2 emissions in 1962")
df %>%
filter(Year == 1962) %>%
ggplot(aes(y = co2PerCap, x = gdpPercap)) +
theme_classic() +
scale_y_log10() +
scale_x_log10() +
geom_point(color = "red") +
ggtitle("log GDP vs. log CO2 emissions in 1962") +
xlab("log GDP in purchasing power parity (USD per capita)") +
ylab("log CO2 emissions (metric tons per capita)")
df <- df %>%
mutate(logCO2 = log10(co2PerCap), logGDP = log(gdpPercap))
mod <- cor.test(x = df$logCO2, y = df$logGDP) %>% tidy()
mod
res <- df %>%
group_by(Year) %>%
summarise(
tidy(
cor.test(x = co2PerCap, y = gdpPercap, method = "kendall")
)
) %>%
dplyr::slice_max(estimate, n = 1)
res
fig <- df %>%
filter(Year == res$Year) %>%
plot_ly(
x = ~logGDP,
y = ~logCO2,
size = ~pop,
color = ~continent,
# frame = ~Year,
text = ~`Country Name`,
hoverinfo = "text",
type = "scatter",
mode = "markers"
)
fig <- fig %>% layout(
xaxis = list(
type = "log"
)
)
fig %>%
layout(
title = "log GDP vs. log CO2 emissions in 2002", plot_bgcolor = "#e5ecf6", xaxis = list(title = "log CO2 Emissions"),
yaxis = list(title = "log GDP"), legend = list(title = list(text = "<b> Continent </b>"))
)
res <- df %>%
filter(!is.na(continent)) %>%
kruskal.test(continent, energyUsePerCap) %>%
tidy()
mod <- df %>%
filter(continent %in% c("Asia", "Europe"), Year > 1990) %>%
glm(importPercentageGDP ~ continent, data = .) %>%
tidy()
mod
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
dplyr::slice_max(estimate, n = 3)
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
slice(1:3) %>%
ggplot(data = ., aes(x = as.factor(Year), y = popDensityPerSqKm, fill = as.factor(`Country Name`))) +
geom_bar(position = "dodge", stat = "identity") +
theme_classic() +
labs(x = "Year", y = "population density (per sq.km)", fill = "Country") +
ggtitle("Population density in the top 5 highest density countries in Years 1962-2007")
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
dplyr::slice_max(Year, n = 1)
ggplot(data = ., aes(x = as.factor(Year), y = popDensityPerSqKm, fill = as.factor(`Country Name`))) +
geom_bar(position = "dodge", stat = "identity") +
theme_classic() +
labs(x = "Year", y = "population density (per sq.km)", fill = "Country") +
ggtitle("Population density in the top 5 highest density countries in Years 1962-2007")
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
dplyr::slice_max(Year, n = 1)
ggplot(data = ., aes(x = as.factor(Year), y = popDensityPerSqKm, fill = as.factor(`Country Name`))) +
geom_bar(position = "dodge", stat = "identity") +
theme_classic() +
labs(x = "Year", y = "population density (per sq.km)", fill = "Country") +
ggtitle("Population density in the top 5 highest density countries in Years 1962-2007")
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
dplyr::slice_max(Year, n = 3) %>%
ggplot(data = ., aes(x = as.factor(Year), y = popDensityPerSqKm, fill = as.factor(`Country Name`))) +
geom_bar(position = "dodge", stat = "identity") +
theme_classic() +
labs(x = "Year", y = "population density (per sq.km)", fill = "Country") +
ggtitle("Population density in the top 5 highest density countries in Years 1962-2007")
res <- df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year)  %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
) %>%
group_by(`Country Name`) %>%
summarize(mean.rank = mean(rnks))%>%
slice_max(mean.rank,n=3)
res <- df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year)  %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
) %>%
group_by(`Country Name`) %>%
summarize(mean.rank = mean(rnks))%>%
slice_max(mean.rank,n=3)
res
res <- df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year)  %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
) %>%
group_by(`Country Name`) %>%
summarize(mean.rank = mean(rnks))%>%
slice_min(mean.rank,n=3)
res <- df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year)  %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
) %>%
group_by(`Country Name`) %>%
summarize(mean.rank = mean(rnks))%>%
slice_min(mean.rank,n=3)
res
res <- df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
#  group_by(Year)  %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
) %>%
group_by(`Country Name`) %>%
summarize(mean.rank = mean(rnks))%>%
slice_min(mean.rank,n=3)
res
res <- df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year)  %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
) %>%
group_by(`Country Name`) %>%
summarize(mean.rank = mean(rnks))%>%
slice_min(mean.rank,n=3)
res
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
dplyr::slice_max(Year, n = 3
exit
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
dplyr::slice_max(Year, n = 3
)
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
dplyr::slice_min(Year, n = 3)
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
dplyr::slice_max(popDensityPerSqKm, n = 3)
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
dplyr::slice_max(popDensityPerSqKm, n = 3) %>%
ggplot(data = ., aes(x = as.factor(Year), y = popDensityPerSqKm, fill = as.factor(`Country Name`))) +
geom_bar(position = "dodge", stat = "identity") +
theme_classic() +
labs(x = "Year", y = "population density (per sq.km)", fill = "Country") +
ggtitle("Population density in the top 5 highest density countries in Years 1962-2007")
df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
dplyr::slice_max(popDensityPerSqKm, n = 3) %>%
ggplot(data = ., aes(x = as.factor(Year), y = popDensityPerSqKm, fill = as.factor(`Country Name`))) +
geom_bar(position = "dodge", stat = "identity") +
theme_classic() +
labs(x = "Year", y = "population density (per sq.km)", fill = "Country") +
ggtitle("Population density in the top 5 highest density countries in Years 1962-2007")
styler::style_file()
styler::style_file("R for DS.Rmd")
list.of.packages <- c(
"tidyverse", "dplyr",
"styler", "reshape2",
"broom", "plotly", "kableExtra"
)
list.of.packages <- c(
"tidyverse", "dplyr",
"styler", "reshape2",
"broom", "plotly", "kableExtra"
)
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[, "Package"])]
if (length(new.packages)) {
install.packages(new.packages)
}
lapply(list.of.packages, require, character.only = TRUE)
df <- df %>%
mutate(logCO2 = log10(co2PerCap), logGDP = log(gdpPercap))
mod <- cor.test(x = df$logCO2, y = df$logGDP) %>% tidy()
mod() %>%kbl() %>%
kable_styling()
mod %>%kbl() %>%
kable_styling()
res <- df %>%
filter(!is.na(continent)) %>%
kruskal.test(continent, energyUsePerCap) %>%
tidy()
res %>%
kbl() %>%
kable_styling()
res$"Country Name"[1]
res$"Country Name"[2]
res
res <- df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
) %>%
group_by(`Country Name`) %>%
summarize(mean.rank = mean(rnks)) %>%
slice_min(mean.rank, n = 3)
res %>%
kbl() %>%
kable_styling()
res
res$`Country Name`
res$`Country Name`[2]
res <- df %>%
select(Year, `Country Name`, popDensityPerSqKm) %>%
arrange(Year, desc(popDensityPerSqKm)) %>%
group_by(Year) %>%
mutate(
rnks = row_number(desc(popDensityPerSqKm))
) %>%
group_by(`Country Name`) %>%
summarize(mean.rank = mean(rnks)) %>%
slice_min(mean.rank, n = 3)
res %>%
kbl() %>%
kable_styling()
country1 = res$`Country Name`[1]
country2 = res$`Country Name`[2]
fig <- df %>%
filter(Year == res$Year) %>%
plot_ly(
x = ~logGDP,
y = ~logCO2,
size = ~pop,
color = ~continent,
# frame = ~Year,
text = ~`Country Name`,
hoverinfo = "text",
type = "scatter",
mode = "markers"
)
styler::style_file()
styler::style_file("R for DS.rmd")
