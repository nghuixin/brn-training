---
title: "RNASeq_Analysis"
author: "Hui Xin Ng"
date: "2022-09-06"
output: html_document
---
 
##  
```{r  , echo=FALSE}
packages <- c("tidyr", "dplyr", "DESeq2", "pheatmap", "enrichR", "msigdbr")
 
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
  install.packages(packages[!installed_packages])
}
invisible(lapply(packages, library, character.only = TRUE))
```


```{r}
df1 <- read.table("GSE54112_TPM_all.txt.gz", stringsAsFactors = FALSE, sep = "", header = TRUE)
 

sample_info <- read.csv("sample_info.csv")

sample_info <- separate(sample_info, group, into = c("sampleID", "group"), sep = ",")
sample_info <- separate(sample_info, sampleID, into = c("ID", "groupName", "name"), sep = " ")
rownames(sample_info) <- sample_info$ID
sample_info$ID <- NULL 
rownames(sample_info) <- str_remove_all(tolower(rownames(sample_info)) ,"_")


rownames(df1) <- df1$ID
df1$ID <- NULL
 
df1 <- df1   %>% 
  mutate_if(is.numeric, round) %>% replace(is.na(.), 0)

df1 <- df1 %>% replace(is.na(.), 0)
df1 <- df1 %>% select(rownames(sample_info))
df1
```

```{r}
all(colnames(df1) %in% rownames(sample_info))

# are they in the same order?
all(colnames(df1) == rownames(sample_info))
```

```{r}
dds <- DESeqDataSetFromMatrix(countData = round(df1/2), colData = sample_info, design = ~group)
```
 